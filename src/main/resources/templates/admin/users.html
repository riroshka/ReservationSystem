<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: head(pageTitle='Управление пользователями')">
    <meta charset="UTF-8">
    <title>Управление пользователями</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
<div th:replace="fragments/header :: header"></div>

<div class="users-table-container">
    <h1>Управление пользователями</h1>

    <!-- Кнопки фильтрации по ролям -->
    <div class="role-buttons">
        <a th:href="@{/admin/users}"
           class="role-btn"
           th:classappend="${currentRole == null} ? 'active'">
            Все
        </a>

        <a th:each="role : ${roles}"
           th:href="@{/admin/users(role=${role})}"
           class="role-btn"
           th:classappend="${currentRole == role} ? 'active'"
           th:text="${#strings.capitalize(#strings.toLowerCase(role.name()))}">
        </a>
    </div>

    <table class="users-table">
        <thead>
        <tr>
            <th>ФИО</th>
            <th>Email</th>
            <th>Логин</th>
            <th>Роль</th>
            <th>Телефон</th>
            <th>Группа</th>
            <th>Действия</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="user : ${users}">
            <td th:text="${user.fullName}"></td>
            <td th:text="${user.email}"></td>
            <td th:text="${user.login}"></td>
            <td th:text="${user.role}"></td>
            <td th:text="${user.phoneNumber}"></td>
            <td th:text="${user.studentGroup} ?: '-'"></td>
            <td>
                <a th:href="@{/admin/users/edit/{id}(id=${user.userId})}" class="btn">Редактировать</a> |
                <a th:href="@{/admin/users/delete/{id}(id=${user.userId})}" class="btn"
                   onclick="return confirm('Вы уверены что хотите удалить пользователя?')">Удалить</a>
            </td>
        </tr>
        <tr th:if="${#lists.isEmpty(users)}">
            <td colspan="7" style="text-align: center;">
                Пользователи не найдены
            </td>
        </tr>
        </tbody>
    </table>

    <div class="center-btn-container">
        <a href="/admin/users/create" class="btn">Добавить нового пользователя</a>
    </div>
</div>

<script>
    // обработчик для кнопок фильтрации
    document.addEventListener('DOMContentLoaded', function() {
        const buttons = document.querySelectorAll('.role-btn');
        buttons.forEach(btn => {
            btn.addEventListener('click', function() {
                buttons.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
            });
        });
    });
</script>

<script src="/js/scripts.js"></script>
</body>
</html>
